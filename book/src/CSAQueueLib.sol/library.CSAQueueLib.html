<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CSAQueueLib</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">src</li><li class="chapter-item "><a href="../../src/CSAC.sol/contract.CSAC.html">CSAC</a></li><li class="chapter-item "><a href="../../src/CSAConverter.sol/contract.CSAConverter.html">CSAConverter</a></li><li class="chapter-item "><a href="../../src/CSAEngineV2.sol/contract.CSAEngineV2.html">CSAEngineV2</a></li><li class="chapter-item "><a href="../../src/CSAMarketplace.sol/contract.CSAMarketplace.html">CSAMarketplace</a></li><li class="chapter-item "><a href="../../src/CSAMarketplaceNative.sol/contract.CSAMarketplaceNative.html">CSAMarketplaceNative</a></li><li class="chapter-item "><a href="../../src/CSAOracleV2.sol/contract.CSAOracleV2.html">CSAOracleV2</a></li><li class="chapter-item expanded "><a href="../../src/CSAQueueLib.sol/library.CSAQueueLib.html" class="active">CSAQueueLib</a></li><li class="chapter-item "><a href="../../src/CSASwap.sol/contract.CSASwap.html">CSASwap</a></li><li class="chapter-item "><a href="../../src/CSAT.sol/contract.CSAT.html">CSAT</a></li><li class="chapter-item "><a href="../../src/CSAVault.sol/contract.CSAVault.html">CSAVault</a></li><li class="chapter-item "><a href="../../src/CSAVaultNative.sol/contract.CSAVaultNative.html">CSAVaultNative</a></li><li class="chapter-item "><a href="../../src/IBurnableMintable.sol/interface.Mintable.html">Mintable</a></li><li class="chapter-item "><a href="../../src/IBurnableMintable.sol/interface.Burnable.html">Burnable</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="csaqueuelib"><a class="header" href="#csaqueuelib">CSAQueueLib</a></h1>
<p><strong>Author:</strong>
Maurizio Murru</p>
<p><em>A library that provides a basic Queue data structure with Order elements.
It provides functions to add, remove, update, and get elements from the Queue.
The Queue keeps track of the head and tail, and each Order has a link to its previous
and next Order, forming a doubly linked list.</em></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="max_orders_removable"><a class="header" href="#max_orders_removable">MAX_ORDERS_REMOVABLE</a></h3>
<pre><code class="language-solidity">uint256 constant MAX_ORDERS_REMOVABLE = 10;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="add"><a class="header" href="#add">add</a></h3>
<p><em>Adds a new order to the end of the queue.</em></p>
<pre><code class="language-solidity">function add(Queue storage self, address _owner, uint256 _amount) internal returns (uint48);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to add the order to.</td></tr>
<tr><td><code>_owner</code></td><td><code>address</code></td><td>The address of the order owner.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of the order.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48</code></td><td>The new tail of the queue.</td></tr>
</tbody></table>
</div>
<h3 id="remove"><a class="header" href="#remove">remove</a></h3>
<p><em>Removes an order from the queue.</em></p>
<pre><code class="language-solidity">function remove(Queue storage self, uint48 orderId) internal returns (Receipt memory receipt);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to remove the order from.</td></tr>
<tr><td><code>orderId</code></td><td><code>uint48</code></td><td>The ID of the order to remove.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>receipt</code></td><td><code>Receipt</code></td><td>The receipt of the removed order. Emits an {OrderNotFound} event if the order is not found in the queue.</td></tr>
</tbody></table>
</div>
<h3 id="multipleremove"><a class="header" href="#multipleremove">multipleRemove</a></h3>
<p>This function requires that the orderIds are valid and subsequent.</p>
<p>This function requires that the number of orderIds is less than or equal to MAX_ORDERS_REMOVABLE.</p>
<p>This function returns an empty array if the first orderId is 0.</p>
<p><em>Removes multiple orders from the queue by their orderIds.</em></p>
<pre><code class="language-solidity">function multipleRemove(Queue storage self, uint48[] memory orderIds) internal returns (Receipt[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to remove orders from.</td></tr>
<tr><td><code>orderIds</code></td><td><code>uint48[]</code></td><td>The array of orderIds to remove.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Receipt[]</code></td><td>An array of Receipt structs containing the owner and amount of each removed order.</td></tr>
</tbody></table>
</div>
<h3 id="removetrailingzeros"><a class="header" href="#removetrailingzeros">removeTrailingZeros</a></h3>
<p><em>Removes trailing zeros from an array of uint48.</em></p>
<pre><code class="language-solidity">function removeTrailingZeros(uint48[] memory arr) internal pure returns (uint48[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>arr</code></td><td><code>uint48[]</code></td><td>The input array to remove trailing zeros from.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48[]</code></td><td>A new array with the trailing zeros removed.</td></tr>
</tbody></table>
</div>
<h3 id="update"><a class="header" href="#update">update</a></h3>
<p><em>Updates the amount of an order in the queue.</em></p>
<pre><code class="language-solidity">function update(Queue storage self, uint48 orderId, uint256 newAmount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to update.</td></tr>
<tr><td><code>orderId</code></td><td><code>uint48</code></td><td>The ID of the order to update.</td></tr>
<tr><td><code>newAmount</code></td><td><code>uint256</code></td><td>The new amount of the order.</td></tr>
</tbody></table>
</div>
<h3 id="head"><a class="header" href="#head">head</a></h3>
<p><em>Returns the ID of the first order in the queue.</em></p>
<pre><code class="language-solidity">function head(Queue storage self) internal view returns (uint48);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to get the head of.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48</code></td><td>The ID of the first order in the queue.</td></tr>
</tbody></table>
</div>
<h3 id="tail"><a class="header" href="#tail">tail</a></h3>
<p><em>Returns the ID of the last order in the queue.</em></p>
<pre><code class="language-solidity">function tail(Queue storage self) internal view returns (uint48);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to get the tail of.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48</code></td><td>The ID of the last order in the queue.</td></tr>
</tbody></table>
</div>
<h3 id="get"><a class="header" href="#get">get</a></h3>
<p><em>Returns the order with the given ID.</em></p>
<pre><code class="language-solidity">function get(Queue storage self, uint48 orderId) internal view returns (Order memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to get the order from.</td></tr>
<tr><td><code>orderId</code></td><td><code>uint48</code></td><td>The ID of the order to get.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Order</code></td><td>The order with the given ID.</td></tr>
</tbody></table>
</div>
<h3 id="next"><a class="header" href="#next">next</a></h3>
<p><em>Returns the ID of the order that comes after the given order in the queue.</em></p>
<pre><code class="language-solidity">function next(Queue storage self, uint48 orderId) internal view returns (uint48);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to get the next order from.</td></tr>
<tr><td><code>orderId</code></td><td><code>uint48</code></td><td>The ID of the order to get the next order of.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48</code></td><td>The ID of the order that comes after the given order in the queue.</td></tr>
</tbody></table>
</div>
<h3 id="prev"><a class="header" href="#prev">prev</a></h3>
<p><em>Returns the ID of the order that comes before the given order in the queue.</em></p>
<pre><code class="language-solidity">function prev(Queue storage self, uint48 orderId) internal view returns (uint48);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to get the previous order from.</td></tr>
<tr><td><code>orderId</code></td><td><code>uint48</code></td><td>The ID of the order to get the previous order of.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint48</code></td><td>The ID of the order that comes before the given order in the queue.</td></tr>
</tbody></table>
</div>
<h3 id="getorders"><a class="header" href="#getorders">getOrders</a></h3>
<p><em>Returns an array of all orders in the queue.</em></p>
<pre><code class="language-solidity">function getOrders(Queue storage self) internal view returns (Order[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>Queue</code></td><td>The queue to retrieve orders from.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Order[]</code></td><td>An array of Order structs representing the orders in the queue.</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="ordernotfound"><a class="header" href="#ordernotfound">OrderNotFound</a></h3>
<p>Custom errors</p>
<pre><code class="language-solidity">error OrderNotFound(uint128 orderId);
</code></pre>
<h3 id="ordersnotsubsequent"><a class="header" href="#ordersnotsubsequent">OrdersNotSubsequent</a></h3>
<pre><code class="language-solidity">error OrdersNotSubsequent(uint128 orderId);
</code></pre>
<h3 id="toomanyorderstoremove"><a class="header" href="#toomanyorderstoremove">TooManyOrdersToRemove</a></h3>
<pre><code class="language-solidity">error TooManyOrdersToRemove(uint256 amount);
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="order"><a class="header" href="#order">Order</a></h3>
<p><em>Represents an order in the Queue.</em></p>
<pre><code class="language-solidity">struct Order {
    address owner;
    uint48 next;
    uint48 prev;
    uint256 amount;
}
</code></pre>
<h3 id="receipt"><a class="header" href="#receipt">Receipt</a></h3>
<p><em>Represents a receipt of an order in the Queue.</em></p>
<pre><code class="language-solidity">struct Receipt {
    address owner;
    uint256 amount;
}
</code></pre>
<h3 id="queue"><a class="header" href="#queue">Queue</a></h3>
<p><em>Represents the Queue data structure.</em></p>
<pre><code class="language-solidity">struct Queue {
    uint48 head;
    uint48 tail;
    mapping(uint128 =&gt; Order) orders;
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../src/CSAOracleV2.sol/contract.CSAOracleV2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../src/CSASwap.sol/contract.CSASwap.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../src/CSAOracleV2.sol/contract.CSAOracleV2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../src/CSASwap.sol/contract.CSASwap.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../solidity.min.js"></script>


    </div>
    </body>
</html>
